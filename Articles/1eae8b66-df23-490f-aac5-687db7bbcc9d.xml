<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="0" Content_Hash="0">
  <Metadata>
    <Id>1eae8b66-df23-490f-aac5-687db7bbcc9d</Id>
    <Library_Id>be5273b1-d682-4361-99d9-6204f2d47eb7</Library_Id>
    <Title>Trust Relationship Vulnerability</Title>
    <Category />
    <Phase />
    <Technology />
    <Type />
    <DirectLink>Trust Relationship Vulnerability</DirectLink>
    <Author />
    <Priority />
    <Status />
  </Metadata>
  <Content Sanitized="false" DataType="wikitext">
    <Data><![CDATA[=Description=

An attacker may be able to exploit the trust relationship between two or more systems or elements of systems if that trust is improperly assigned. All complex systems have many different trust relationships, and it's easy for that trust to get out of sync. Furthermore, trust relationships can allow an attacker to leapfrog between systems, exploiting the trust they gain by compromising one system to extend their hold to other systems. Trust relationships are sometimes specified too weakly, resulting in trust relationships where a host is trusted simply because of an IP address or other spoofable identifier; these types of trust relationships are particularly fruitful for attackers.

Applications which do not recognize the cases when they're trusting other systems are a particular issue here, but any time trust is granted in an overly broad way, issues arise.

Identifying another system based on IP, Mac address, fingerprint, DNS name, or other information which only provides weak identification can allow an attacker to exploit that trust to gain access to those systems.

Trusting a client to do no evil sets the stage for an attacker to break into that system and choose what malicious actions to perform

=Impact=

An attacker may use a trust relationship to piggyback into other systems to execute commands or read/write/update/delete data on other systems.

With improper relationships an attacker may be able to read information they should not have access to

=Countermeasures=

Develop a threat model: A threat model can specify all the places where entities should trust one another. These relationships can then be analyzed for correctness and their implementations audited.

Authenticate all clients: All clients must be securely authenticated using proper techniques.

Do not base trust on spoofable information: Do not trust a client or server based on IP, Mac address, or other spoofable information. Require all clients to be strongly authenticated.

=Application Check=

]]></Data>
  </Content>
</TeamMentor_Article>