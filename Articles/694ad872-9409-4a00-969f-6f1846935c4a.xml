<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="0" Content_Hash="0">
  <Metadata>
    <Id>694ad872-9409-4a00-969f-6f1846935c4a</Id>
    <Library_Id>be5273b1-d682-4361-99d9-6204f2d47eb7</Library_Id>
    <Title>Business Rule Vulnerability</Title>
    <Category />
    <Phase />
    <Technology />
    <Type />
    <DirectLink>Business Rule Vulnerability</DirectLink>
    <Author />
    <Priority />
    <Status />
  </Metadata>
  <Content Sanitized="false" DataType="wikitext">
    <Data><![CDATA[=Description=

A business rule defines the constraints on how the application interacts at a high level. Business rules define the procedures that must be followed, the relationships that must be maintained between assets, and the set of rules around who's allowed to take which actions. All systems have business rules, be they very simple ones, like those around a read-only web site, or complex ones, like those embedded in a complex ERP system. The business rules of a system rarely exist in any specifically concrete form, and are normally spread throughout the application in a very ad-hoc manner, making them hard to audit and maintain.

An attack against the business rules of a system involves an attacker subverting the functionality of a system, instead of merely breaking the underlying code. If an application can be attacked through its business rules, it means that either the rules are not being enforced properly throughout the entire system, or that the rules of the system (often and especially the rules which determine relationships between modules, instead of intramodule rules) are not entirely consistent, and that this inconsistency can be exploited by an attacker. The fact that business rule attacks work entirely within the bounds of the system, most of the time, makes them much harder to detect and prevent; a simple code audit will not be sufficient to find these issues. Furthermore, because business rules define the basic function and purpose of an application, attacks against business rules are often some of the more profitable attacks for an attacker, and the more devastating ones for a victim.

=Impact=

In the strictest sense, most of the issues from a business rule will be elevation of privilege issues, allowing the attacker to do things which are normally prohibited.

As part and parcel of the elevation of privilege issues come information discosure issues. 

It is often the case in more complicated applications that subverting the business rules of an application can make it either effctively non-functional, resulting in deadlock of one kind or another.

=Countermeasures=

Document the business rules of the system in a single place.

Generate a threat model of the application and carefully analyze the business rules as specified.

Centralize business rule code for easier auditing. 

Audit the application code to ensure that all pathways through the system enforce the business rules as specified and that no extra functionality exists in the system beyond that specified in the rules of the system.

=Application Check=

]]></Data>
  </Content>
</TeamMentor_Article>