<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="-255242240" Content_Hash="-1991230800">
  <Metadata>
    <Id>4c56f015-31b0-4570-a194-707d9cf6db26</Id>
    <Id_History>e49c6b3a-880f-46db-a07d-80dc2177a36a,</Id_History>
    <Library_Id>be5273b1-d682-4361-99d9-6204f2d47eb7</Library_Id>
    <Title>Business Rule Attack</Title>
    <Category>Input and Data Validation</Category>
    <Phase>Implementation</Phase>
    <Technology> Any</Technology>
    <Type>Attack</Type>
    <DirectLink>Business Rule Attack</DirectLink>
    <Tag />
    <Security_Demand />
    <Author />
    <Priority>2</Priority>
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="wikitext">
    <Data><![CDATA[=Applies To

All applications.
=Description

A business rule defines the constraints on how the application interacts at a high level. Business rules define the procedures that must be followed, the relationships that must be maintained between assets, and the set of rules around who's allowed to take which actions. All systems have business rules, be they very simple ones, like those around a read-only web site, or complex ones, like those embedded in a complex ERP system. The business rules of a system rarely exist in any specifically concrete form, and are normally spread throughout the application in a very ad-hoc manner, making them hard to audit and maintain.

An attack against the business rules of a system involves an attacker subverting the functionality of a system, instead of merely breaking the underlying code. If an application can be attacked through its business rules, it means that either the rules are not being enforced properly throughout the entire system, or that the rules of the system (often and especially the rules which determine relationships between modules, instead of intramodule rules) are not entirely consistent, and that this inconsistency can be exploited by an attacker. The fact that business rule attacks work entirely within the bounds of the system, most of the time, makes them much harder to detect and prevent; a simple code audit will not be sufficient to find these issues. Furthermore, because business rules define the basic function and purpose of an application, attacks against business rules are often some of the more profitable attacks for an attacker, and the more devastating ones for a victim.
=Impact

    *Elevation of privilege: In the strictest sense, most of the issues from a business rule will be elevation of privilege issues, allowing the attacker to do things which are normally prohibited.
    *Information disclosure: As part and parcel of the elevation of privilege issues come information discosure issues.
    *Denial of service: It is often the case in more complicated applications that subverting the business rules of an application can make it either effectively non-functional, resulting in deadlock of one kind or another.

=Vulnerabilities

    *Internal inconsistencies in the business rules of the system.
    *Failure to enforce business rules uniformly at all points in the system.

=Countermeasures

    *Document the business rules of the system in a single place.
    *Generate a threat model of the application and carefully analyze the business rules as specified.
    *Centralize business rule code for easier auditing.
    *Audit the application code to ensure that all pathways through the system enforce the business rules as specified and that no extra functionality exists in the system beyond that specified in the rules of the system.

=Additional Resources

    For more information on Business Logic, see: http://en.wikipedia.org/wiki/Business_logic
    For more information on Threat Modeling, see: http://msdn2.microsoft.com/en-us/security/aa570413.aspx

=Related Items

    Attack: Denial of Service Attack
    Attack: Trust Relationship Attack
    Attack: Repudiation Attack
    Attack: Creation of False Transaction Attack
    Attack: Social Engineering Attack
    Attack: Information Disclosure Attack
    Guideline: Do Not Make Security Decisions Based on Client-Accessible Parameters
    Guideline: Perform Role-Based Security Checks
    Guideline: Separate Account Administration from the Main Application Interface
    Guideline: Partition Application Between Public and Private Domains
]]></Data>
  </Content>
</TeamMentor_Article>