<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="-134630211" Content_Hash="-587486448">
  <Metadata>
    <Id>8482159c-5ec2-4b89-9c65-9af765030ff5</Id>
    <Id_History>7d83d845-cd2b-4067-bb4c-5fbb890b9c9e,</Id_History>
    <Library_Id>be5273b1-d682-4361-99d9-6204f2d47eb7</Library_Id>
    <Title>Information Disclosure Attack</Title>
    <Category>Sensitive Data</Category>
    <Phase>Implementation</Phase>
    <Technology> Any</Technology>
    <Type>Attack</Type>
    <DirectLink>Information Disclosure Attack</DirectLink>
    <Tag />
    <Security_Demand />
    <Author />
    <Priority>1</Priority>
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[<br />
  <br />
  <h1>Applies To</h1>
  <p>Any application that restricts access to certain types of information, including configuration and deployment details.</p>
  <h1>Description</h1>
  <p>An Information Disclosure attack results in an application revealing sensitive information to the attacker. Examples of sensitive information include system specific data such as overly descriptive error messages, source code, software distribution and version numbers, database information, passwords, machine names and file paths to other sensitive areas.</p>
  <p>For web applications there are several methods that can be used by an attacker to get more information from the application, such as directory indexing, path traversal, reading source code or error messages and comments left behind by developers, etc. </p>
  <p>If the attacker can gain access to the binaries of the application (in the case of an installed client application), or through forceful browsing or other attacks (for a server application), the information disclosure attack surface becomes much larger. In this case the attacker can employ debuggers, decompilers, hex editors and other tools to search for secrets left in the application. </p>
  <p>SQL injection, whether in a web application or installed client application, can also be considered a type of information disclosure attack because it can be used to access sensitive information that is stored in a database, as can other similar query-based attacks.</p>
  <h1>Impact</h1>
  <ul>
    <li>
      <strong>Confidentiality</strong>: An attacker gains access to sensitive information which may be used to launch further exploits against the application, or which may be of direct value (sensitive user information such as passwords or social security numbers, for instance) </li>
    <li>
      <strong>Authentication</strong>: Through an error message that reveals too much information or a SQL injection exploit, an attacker may be able to figure out another user's ID and password, and log in as that user. </li>
  </ul>
  <h1>Vulnerabilities</h1>
  <ul>
    <li>
      <strong>Improper permissions: </strong>Through forceful browsing an attacker may be able to discover sensitive information that should not be available such as source code, binaries, backup files, etc. </li>
    <li>
      <strong>Directory indexing left on: </strong>This can allow an attacker to freely browse an entire directory on a website which can tell an attacker all available files on the server. </li>
    <li>
      <strong>Storing sensitive data in plaintext:</strong> Storing sensitive data in plain or weakly encoded text can lead to an attacker discovering username/password pairs, cryptography keys, or other sensitive data </li>
    <li>
      <strong>Detailed error messages:</strong> Propagating SQL errors, exception handler errors or stack traces do not help users solve a problem but can drastically reduce the amount of time it takes an attacker to exploit a system. </li>
    <li>
      <strong>Comments left in code:</strong> The client downloads and has access to all client side code. Any comments left in HTML, AJAX, or other script can easily be discovered. </li>
    <li>
      <strong>Hard coded usernames and passwords:</strong> Opening an application in a hex editor will show any hard coded strings in the application, this can lead an attacker directly to hard coded credentials </li>
    <li>
      <strong>Running with more privilege than is needed:</strong> This can allow an attacker to gain access to information on the server that should not be available. Permissions should be limited for all users including: SQL, Web Service, Web Application, etc.</li>
  </ul>
  <h1>Countermeasures</h1>
  <ul>
    <li>
      <strong>Use language specific comments:</strong> These comments will be automatically removed by the parsing or compiling engine and are not visible client side. Note: be careful with comments that are similar to HTML comments such as ColdFusion comments ( &lt;!--- comment ---&gt; ). </li>
    <li>
      <strong>Use proper permissions:</strong> Restrict access to files and directories on the server, so users cannot access any file they want using directory/path traversal. </li>
    <li>
      <strong>Use strong encryption algorithms:</strong> whenever sensitive data is stored ensure that it is properly protected using strong encryption </li>
    <li>
      <strong>Use least privilege:</strong> Ensure that your application uses the principle of least privilege if it uses a backend database server. </li>
    <li>
      <strong>Use terse error messages:</strong> Be sure to only use short, generic error messages that don't reveal any sensitive information and never directly display error messages returned by a back-end database or other system. </li>
    <li>
      <strong>Use the principle of open design:</strong> When designing an application, assume the attacker has access to all information; bake security into your application so even with this information no further attacks are possible</li>
  </ul>
  <h1>Example</h1>
  <p>
    <strong>Directory indexing</strong>: The HTTP request 'GET /&lt;null byte&gt;.jsp HTTP/1.0' allows an attacker to view the directory and file listing due to improper handling of null bytes </p>
  <p>
    <strong>Directory traversal</strong>: The URL http://www.example.com/../restricted-file.cgi allows an attacker to access the file 'restricted-file.cgi' which lies outside the web document root directory </p>
  <p>
    <strong>Directory traversal with encoded characters</strong>: The URL http://www.example.com/..%255c..%255c/restricted-file.cgi is similar to the one above, but the '/' characters are double encoded to bypass security filters</p>
  <p>
    <strong>Examples of too much information in error messages:</strong>
  </p>
  <ul>
    <li>Invalid password for user: test </li>
    <li>User test does not exist in this system </li>
    <li>Unclosed ‘ character near ‘); </li>
    <li>Any error message that reflects internal component exceptions such as SQL, internal libraries, SSL, encryption, etc.</li>
  </ul>
  <h1>Additional Resources</h1>
  <ul>
    <li>For more about Information Leakage, see <a href="http://projects.webappsec.org/w/page/13246936/Information%20Leakage">http://projects.webappsec.org/w/page/13246936/Information%20Leakage</a></li>
  </ul>
  <h1>Related Items</h1>
  <ul>
    <li>
      <a href="/article/08f2f28f-d09a-4b82-843e-8d971fc50553">Guideline: Do Not Disclose Valuable Information in Error Messages </a>
    </li>
    <li>
      <a href="/article/74be8616-ad22-4d1d-a7fc-8ff3d145fc61">Guideline: Do Not Disclose Exception Details to the Client </a>
    </li>
    <li>
      <a href="/article/9e18ec6e-1100-4423-b5cf-60b2e117ca25">Attack: Xpath-XQuery Attack</a>
    </li>
    <li>
      <a href="/article/110cc11a-5a28-4fc2-a269-4210069b8865">Attack: Server-Side Code Injection Attack</a>
    </li>
    <li>
      <a href="/article/e0ebf8be-838c-4762-8c44-0d90adf63aef">Attack: Account Lockout Attack</a>
    </li>
    <li>
      <a href="/article/571ecf1a-d80c-475b-a0db-aff07069c997">Attack: XML Injection Attack</a>
    </li>
    <li>
      <a href="/article/2a28f8b4-6907-4fa2-b8db-0c96ef4912ec">Attack: Local Machine Credential Sniffing Attack</a>
    </li>
    <li>
      <a href="/article/4e938b66-254d-42ce-b714-a5de348b37e7">Attack: Traffic Analysis Attack</a>
    </li>
    <li>
      <a href="/article/8062c64d-ca73-428b-b35a-e7e5952b9da5">Attack: SQL Injection Attack</a>
    </li>
    <li>
      <a href="/article/dc172f55-185d-4c34-996a-1e368662f3f7">Attack: Exception Information Disclosure Attack</a>
    </li>
    <li>
      <a href="/article/74e70134-b639-4cdc-b3e7-fe2952256d98">Attack: Network Credential Sniffing Attack</a>
    </li>
    <li>
      <a href="/article/cf06603e-440e-4118-85d5-ad360817fabc">Attack: Network Eavesdropping Attack</a>
    </li>
    <li>
      <a href="/article/88ae773e-d30d-4d76-89ef-41b40f0eb0aa">Attack: Sniff Memory for Secrets Attack</a>
    </li>
    <li>
      <a href="/article/72891dcd-2330-4615-a22a-855a02394277">Attack: Statistical Analysis Attack</a>
    </li>
    <li>
      <a href="/article/ed64300c-6963-4f9d-b3db-6e65acc8c481">Attack: Timing Analysis Attack</a>
    </li>
    <li>
      <a href="/article/61f8ac64-c4e1-4c31-9521-f20a1a64b6fd">Attack: Cross Site Scripting Attack</a>
    </li>
    <li>
      <a href="/article/f9f0a869-98fe-4ac5-9de3-3eaf33306c4b">Attack: Canonicalization Attack</a>
    </li>
    <li>
      <a href="/article/e706145e-6465-4261-96af-a66d6a19a637">Guideline: Do Not Include Debug Data in Output </a>
    </li>
    <li>
      <a href="/article/bdff2308-96e1-4787-9162-a115d1366f76">Guideline: Block Protected Files From Being Retrieved </a>
    </li>
    <li>
      <a href="/article/a96eaddb-5fb2-458e-b5ca-fde05a9a3a06">Guideline: Do Not Place Sensitive Data in Parameters </a>
    </li>
    <li>
      <a href="/article/e1992e93-39c6-4508-9b16-0e07b0939c37">Guideline: Secure Connection Strings </a>
    </li>
    <li>
      <a href="/article/0256b587-e8b1-46e0-8b87-f62b9f816c45">Guideline: Protect Log Files </a>
    </li>
    <li>
      <a href="/article/2c48bbd6-2677-4ab0-80df-57985b90bee4">Guideline: Protect ASP.NET Session State </a>
    </li>
    <li>
      <a href="/article/b070122f-f1d1-47da-a378-57f845d5db61">Guideline: Encrypt Communication Links </a>
    </li>
    <li>
      <a href="/article/bd63d4b0-205d-4d95-9022-86a3f0af5232">Guideline: Use SSL When Transmitting Credentials </a>
    </li>
    <li>
      <a href="/article/51b6776e-c771-4d63-b77d-b16ba295a62f">Guideline: Encrypt Sensitive Data in the Database </a>
    </li>
    <li>
      <a href="/article/c6f3e32d-57b8-44cf-818a-c346d0014c06">Guideline: Do Not Store Plaintext Sensitive Data </a>
    </li>
    <li>
      <a href="/article/67be9ff5-80d7-465e-ae47-2717b705e647">Guideline: Do Not Store Passwords </a>
    </li>
    <li>
      <a href="/article/a92aca4f-314d-40fe-9ecd-e3bbe19a555b">Guideline: Protect Sensitive Data Over the Network </a>
    </li>
    <li>
      <a href="/article/faada3f5-3f50-42fc-b863-5058e3d848cb">Guideline: Protect Sensitive Data Inside Configuration Files </a>
    </li>
    <li>
      <a href="/article/e46483a2-7f7e-4753-aaeb-e330ed9aef02">Guideline: Do Not Log Sensitive Information </a>
    </li>
    <li>
      <a href="/article/fd675679-e8ad-40fc-bac4-d56fc440bc00">Guideline: Disable Directory Browsing </a>
    </li>
  </ul>]]></Data>
  </Content>
</TeamMentor_Article>