<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="1102256527" Content_Hash="1390425320">
  <Metadata>
    <Id>e001f908-8905-40bd-8457-3ca2047537ea</Id>
    <Id_History>ac219c42-ec7a-4a01-be18-d0a76bd66018,</Id_History>
    <Library_Id>be5273b1-d682-4361-99d9-6204f2d47eb7</Library_Id>
    <Title>Session Prediction Attack</Title>
    <Category>Application State</Category>
    <Phase>Implementation</Phase>
    <Technology> Any</Technology>
    <Type>Attack</Type>
    <DirectLink>Session Prediction Attack</DirectLink>
    <Tag />
    <Security_Demand />
    <Author />
    <Priority>1</Priority>
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[<br />
  <br />
  <h1>Applies To</h1>
  <p>Any network application that must keep state through the use of session identifiers.</p>
  <h1>Description</h1>
  <p>In the session prediction attack the malicious user will attempt to discern the method used to create new session IDs for past, current or future sessions. If a session ID can be guessed the attacker can piggyback on the credentials of an authenticated user and masquerade as that user.</p>
  <h1>Impact</h1>
  <p>Elevation of privilege: Session hijacking allows the attacker to act as the user whose session was hijacked.</p>
  <h1>Vulnerabilities</h1>
  <ul>
    <li>Poor or predictable session identifiers - using a small ID space increases the likelihood that IDs will have to be reused and increases the probability of successful session ID guessing </li>
    <li>Long session timeouts - if sessions do not expire or take a very long time to expire an attacker has more time to guess or use sniffed session IDs </li>
    <li>Insecure communications channel - using insecure communication channels will allow an attacker to sniff valid session IDs in real time</li>
  </ul>
  <h1>Countermeasures</h1>
  <ul>
    <li>Use strong random numbers for session identifiers - using a cryptographically secure random number (e.g., GUIDs) generator for session IDs will ensure that the session ID cannot be predicted </li>
    <li>Use a large ID space - this will ensure session IDs are not repeated as often </li>
    <li>Use small session timeout windows - if the timeout window is very small the session may have expired by the time the attacker can guess or sniff a valid session ID. </li>
    <li>Use a secure communication channel - if the communication channel is secure, the attacker will have less data to guess the session ID with, and the possibility of them simply sniffing the session identifier is eliminated. </li>
    <li>Do not reuse session identifiers - Do not reuse session IDs for the same user, assign a new cryptographically random session ID upon every successful login. </li>
  </ul>
  <h1>Example</h1>
  <p>An attacker may attempt to log in multiple times to the server to collect a number of session IDs. Once a large enough set of session IDs have been collected statistical analysis can be done on them to try to predict future session IDs. The attacker may also make sure that the server is not binding the session ID to any other information such as IP or MAC address. This can be done by logging into the service from two different computers using different IPs and swapping the session IDs. </p>
  <p>First the attacker will log in a number of times and pull the session IDs out of response, this could be done manually or using a tool. The session IDs in this example the following session IDs were collected:</p>
  <p>
  </p>
  <table>
    <tbody>
      <tr>
        <td>MTUzNTp1c2VyTmFtZQ==</td>
      </tr>
      <tr>
        <td>MTUzNzp1c2VyTmFtZQ==</td>
      </tr>
      <tr>
        <td>MTUzODp1c2VyTmFtZQ==</td>
      </tr>
      <tr>
        <td>MTU0MDp1c2VyTmFtZQ==</td>
      </tr>
    </tbody>
  </table>
  <p />
  <p>The trailing equals of the session IDs is a tell tale sign of Base64 encoding, so the attacker decodes the session IDs and notices this web application is using incrementing session IDs appended to the username:</p>
  <table>
    <tbody>
      <tr>
        <td>MTUzNTp1c2VyTmFtZQ== </td>
        <td>1535:userName</td>
      </tr>
      <tr>
        <td>MTUzNzp1c2VyTmFtZQ== </td>
        <td>1537:userName</td>
      </tr>
      <tr>
        <td>MTUzODp1c2VyTmFtZQ== </td>
        <td>1538:userName</td>
      </tr>
      <tr>
        <td>MTU0MDp1c2VyTmFtZQ== </td>
        <td>1540:userName</td>
      </tr>
    </tbody>
  </table>
  <p>Once the mechanism is known for predicting session IDs the attacker can then begin attacking the server. The attacker would simply guess a number slightly larger or smaller than the current session ID and append it to a list of known usernames. Successfully generating a valid session identifier in this way would allow the attacker to log in to the server as another user.</p>
  <h1>Additional Resources</h1>
  <ul>
    <li>For more information on Credential and Session Prediction attacks, see: <a href="http://projects.webappsec.org/w/page/13246918/Credential%20and%20Session%20Prediction">http://projects.webappsec.org/w/page/13246918/Credential%20and%20Session%20Prediction</a></li>
  </ul>
  <h1>Related Items</h1>
  <ul>
    <li>
      <a href="/article/72891dcd-2330-4615-a22a-855a02394277">Attack: Statistical Analysis Attack</a>
    </li>
    <li>
      <a href="/article/350d9e10-d3d2-4e15-af89-f6ea84c01320">Attack: Key Bruteforce Attack</a>
    </li>
    <li>
      <a href="/article/74e70134-b639-4cdc-b3e7-fe2952256d98">Attack: Network Credential Sniffing Attack</a>
    </li>
    <li>
      <a href="/article/862e51f1-a026-40f9-826b-7a65fa5dc563">Attack: HTTP Session Hijacking Attack</a>
    </li>
    <li>
      <a href="/article/43c19a37-285d-4cdd-a43b-bdea78eb1686">Attack: HTTP Replay Attack</a>
    </li>
    <li>
      <a href="/article/2c48bbd6-2677-4ab0-80df-57985b90bee4">Guideline: Protect ASP.NET Session State </a>
    </li>
    <li>
      <a href="/article/9df0b518-f832-4a7c-9857-0517638c47db">Guideline: Do Not Make Security Decisions Based on Client-Accessible Parameters </a>
    </li>
    <li>
      <a href="/article/254ddab5-ecd2-4e05-a2b0-861e970bc0d9">Guideline: Protect Session Cookies </a>
    </li>
  </ul>]]></Data>
  </Content>
</TeamMentor_Article>